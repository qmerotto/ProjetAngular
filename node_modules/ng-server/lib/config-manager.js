/*eslint-env node */

// TODO - melhorar esse arquivo
var logger = require('./logger');
//var utilities = require('./utilities');

var fs = require('fs');

function loadConfig (argv, callback) {
    //argv.cf? configFile(argv, callback): cmdLineParams(argv, callback);
    configFile(argv, callback);
}

function configFile(argv, callback) {
    var configFileName = argv.cf || './ng-server.json';
    configFileName = configFileName.replace('=', '');

    fs.access(configFileName, function (err) {
        if (err) throw "Can't access file: " + configFileName;

        fs.readFile(configFileName, function (err, data) {
            
            if (err) throw "Can't read file: " + configFileName;
            var config = JSON.parse(fs.readFileSync(configFileName, 'utf-8'));
            callback(config);
        });
    });
}

/*
function cmdLineParams(argv, callback) {
    var config = { root: {} };

    config.host = argv.a || '0.0.0.0';
    config.utc = argv.u || argv.utc
    
    config.root.path = argv[0];
    config.root.route = '/';

    config.root.port = argv.p || parseInt(process.env.PORT, 10);
    config.root.resources = utilities.createResourcesObjects(argv.r);

    callback(config);
}
*/

exports.loadConfig = loadConfig;