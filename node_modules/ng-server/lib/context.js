/*eslint-env node */

var Server = require('./server');
var Logger = require('./logger');
var Middlewares = require('./middlewares');

module.exports = function (port, config) {
    this.context = config;
    
    // INITIALIZE THE CLASS DEPENDENCIES
    this.init = function () {
          this.context.$server = Server.createNewServer();
          this.context.$logger = new Logger(config.silent, config.utc);
          this.middlewares = new Middlewares(this.context);
          this.middlewares.init();
    };

    // START THE SERVER
    this.startServer = function () {
        var _logger = this.context.$logger;
        
        this.context.$server.listen(port, config.host, function () {
            _logger.success('ng-server running at: ' + config.host + ':' + port);
        });
    };

};
